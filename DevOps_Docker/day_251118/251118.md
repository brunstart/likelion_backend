## git의 가장 큰 장점 : 되돌릴 수 있다.
- 히스토리를 보관하고 있기 때문
- reflog로 이전에 커밋했던 로그를 확인하고 reset으로 해당 커밋으로 갈 수 있다.

## DevOps : Docker + Amazon Linux 환경 구성
- 개발자가 애플리케이션과 그 실행 환경을 하나의 패키지(이미지)로 만들어, 어떤 시스템에서든 동일한 환경으로 빠르게 배포하고 실행할 수 있게 해줌
- 도커를 이용해서 컴퓨터 안에 컨테이너를 만들 수 있다 = 독립적인 컴퓨터를 만들 수 있다.

## docker pull 이미지이름
- 해당 이미지를 가져오라는 명령어
- 실습에서는 2023 버전 다운로드, docker pull amazonlinux:2023

## docker run -it --name myamazonlinux amazonlinux:2023 /bin/bash
- 옵션 설명:
- -i: Interactive (표준 입력 유지)
- -t: TTY (가상 터미널) 할당
- --name myamazonlinux: 컨테이너 이름을 "myamazonlinux"로 지정
- amazonlinux:2023: 사용할 이미지
- /bin/bash: 컨테이너 내부에서 실행할 명령어 (bash 쉘 시작)

## docker start NAMES
- 컨테이너 시작 : NAMES는 내가 정한 별명

## docker exec -it NAMES /bin/bash
- 동작중인 컨테이너를 bash를 통해 진입

## docker stop NAMES
- 컨테이너 정지

## docker rm NAMES
- 컨테이너를 아예 삭제함, start로 실행중인 컨테이너는 삭제할 수 없음, -f 옵션으로 강제삭제는 가능

## 삭제 시 주의사항
- 컨테이너를 삭제(docker rm)하면 Container Layer의 모든 변경 사항이 사라짐 
- 영구적으로 데이터를 보존하려면 볼륨(Volume) 또는 바인드 마운트를 사용

## docker-compose
- 여러 개의 컨테이너 환경을 정의하고 일괄 실행·중지·삭제할 수 있게 해주는 도구
- 여러 컨테이너를 일괄된 환경으로 실행이 가능
- docker-compose up 명령어로 yml 파일 내 설정에 맞게 컨테이너를 생성, 동작
- docker-compose로 실행 시에는 컨테이너 NAME으로 실행하는것이 아니라 service의 이름으로 실행을 해야한다.
```yml
services:
  amazonlinux:
    image: amazonlinux:2023
    container_name: carlinux
    # 컨테이너 실행 시 bash 쉘 사용
    command: /bin/bash
    # 아래 두 설정을 통해 대화형 세션(-it) 효과를 냄
    tty: true
    stdin_open: true
```
- 위 경우는 실행 시 docker-compose exec amazonlinux /bin/bash 커맨드를 입력해야 실행이 된다 (carlinux 아님!)
- docker-compose down : 실행중인 서비스를 중지, 컨테이너 종료 및 삭제, 데이터를 유지하려면 별도의 volumes 설정이 필요

      docker-compose.yml 작성: 서비스(컨테이너)의 이미지, 실행 명령, 환경 설정 등을 정의
      docker-compose up -d: 설정된 모든 컨테이너를 백그라운드 모드로 실행
      docker-compose exec <서비스명> /bin/bash: 실행 중인 컨테이너 내부로 접속하여 리눅스 실습
      docker-compose down: 모든 컨테이너와 네트워크 리소스를 일괄 정리

## SSH로 접속하는 컨테이너 (외부접속)
## Dockerfile 작성
```
FROM amazonlinux:2023

# 1) 패키지 업데이트 & SSH 서버 설치 (passwd도 같이 설치해두면 유용)
RUN yum update -y && \
    yum install -y openssh-server passwd

# 2) root 암호 설정(테스트용)
RUN echo 'root:rootpass' | chpasswd

# 3) SSH 관련 디렉토리 생성 (이미 존재할 수도 있지만, 혹시 몰라서 생성)
RUN mkdir -p /var/run/sshd

# 4) SSH 호스트키 생성 (필수! 이게 없으면 "no hostkeys available" 오류 발생)
RUN ssh-keygen -A

# 5) 비밀번호 로그인을 허용하려면 sshd_config 수정 (필요 시)
RUN sed -i 's/^#PasswordAuthentication.*/PasswordAuthentication yes/' /etc/ssh/sshd_config && \
    sed -i 's/^PasswordAuthentication no/PasswordAuthentication yes/' /etc/ssh/sshd_config && \
    sed -i 's/^#PermitRootLogin.*/PermitRootLogin yes/' /etc/ssh/sshd_config && \
    sed -i 's/^PermitRootLogin prohibit-password/PermitRootLogin yes/' /etc/ssh/sshd_config

# 6) 필요 패키지 설치 (예: git, which 등)
RUN yum install -y git which

# 7) SSH 데몬 포그라운드 실행
CMD ["/usr/sbin/sshd", "-D", "-e"]
```
## 실제 운영 환경에서는 절대 사용 금지, 실무에서는 다음을 사용: - SSH 키 기반 인증 - 강력한 비밀번호 - root 직접 로그인 금지 (일반 사용자 + sudo 사용)

## docker-compose.yml 작성
```yml
services:
  amazonlinux-ssh:
    build: .
    container_name: amazonlinux-ssh
    ports:
      - "2222:22"
    volumes:
      - "./data:/workspace"
    restart: always
```

## 빌드 & 실행
- docker-compose up -d --build --force-recreate
- --build: 이미지가 이미 있어도 Dockerfile을 새로 빌드
- --force-recreate: 설정 변경이 없어도 기존 컨테이너를 제거하고 다시 만들기
- --no-cache: (선택) Docker 빌드 캐시를 사용하지 않고 완전히 새로 빌드

## 로그 확인
- docker logs amazonlinux-ssh

## 접속
- ssh root@127.0.0.1 -p 2222

## yum, dnf 패키지 매니저

## .bashrc
- bash 관련된 설정을 할 수 있는 파일 (프롬프트 등)
- 로그인 한 뒤 source 명령어 사용해야 설정이 적용됨
- .bash_profile에서 로그인하자마자 설정이 적용되게 할 수 있음

## 권한 관련 문자열 ex) dr-xr-x---
- 첫번째 문자
  - \- : 일반파일
  - d : 디렉토리
  - i : 심볼릭링크 (단축키)

- 누가    (User)    (Group)    (기타사용자) 
- 무엇을
  - Read : 4 (r--)
  - Write : 2 (-w-)
  - X execute : 1 (--x)
- ex) 755 --> -rwxr-xr-x : R+W+X=7, R+W=6, R+X=5

## chmod
- rwxr-xr-x (755)
  - chmod 755 script.sh
### 소유자에게 실행 권한 추가
- chmod u+x script.sh

### 기호 의미
- u: user (소유자) 
- g: group (그룹) 
- o: others (기타) 
- a: all (모두) 
- +: 권한 추가 
- \-: 권한 제거 
- =: 권한 설정

## grep
- 파일 내 문자열 검색
- grep [옵션] "검색어" [파일...]