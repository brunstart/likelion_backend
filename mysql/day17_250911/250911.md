## JOIN
-  연결하려는 테이블 수 -1 만큼 JOIN 조건 필요
## ANSI JOIN
1. JOIN ~ ON
2. JOIN ~ USING
3. NATURAL JOIN : 자동으로 같은 이름 컬럼 조인 (원하는 결과가 안나올 수 있음)

## NULL 처리
- ifnull(a, b) : a가 null일 경우 0으로 처리
- COALESCE(a, b, c) : a가 null일 경우 b, b도 null일 경우 c로 처리

## HAVING
- 그룹핑한 결과에 대한 조건을 걸 때 사용
- 전체에 대한 조건을 걸 때는 where 사용

## Non-Equi Join (Theta Join) : 범위 조건 조인
### 기준으로 사용하기 위해 테이블을 만드는 경우가 있음


## OUTER JOIN ⭐⭐⭐
### 내가 더 보고자 하는 테이블을 기준으로 작성 (왼쪽의 정보를 더 보겠다 = deptno가 없어도 조회됨)
```mysql.sql
select e.ename, e.deptno, d.dname
from emp e left outer join dept d
using(deptno);
```

### full outer join
- MySql은 full outer join이 안됨, 다 보려면 union 연산자를 사용해야함
```mysql.sql
select e.ename, e.deptno, d.dname
from emp e right outer join dept d
using(deptno)
union
select e.ename, e.deptno, d.dname
from emp e left outer join dept d
using(deptno);
select *
from emp;
```

## self join (자기 자신과 조인) ⭐⭐
- 똑같은 테이블 두 개가 있다고 생각하면 편함
```mysql.sql
-- 직원과 상사 번호 조회
select
    e.empno 사원번호,
    e.ename 사원이름,
    m.empno 매니저사번,
    m.ename 매니저이름
from emp e, emp m
where e.mgr = m.empno;
```

## 서브 쿼리 ⭐⭐⭐
- 쿼리 속에 또 다른 쿼리가 있는것
### single row subquery (서브 쿼리 결과문이 한줄)
- 단순 비교 연산자 사용 ( =, >, <, >=, <=, <> )
```mysql.sql
-- SCOTT의 급여보다 높은 급여를 받는 사람
SELECT ename
FROM emp
WHERE sal > (
    SELECT sal
    FROM emp
    WHERE ename = 'SCOTT'
);
```
### 다중컬럼 서브쿼리
```mysql.sql
-- 각 부서별 최고 급여를 받는 사원
SELECT deptno, empno, ename, sal
FROM emp
WHERE (deptno, sal) IN (
    SELECT deptno, MAX(sal)
    FROM emp
    GROUP BY deptno
);
```

### multi row subquery (서브 쿼리 결과문이 여러줄)
- 단순 비교 연산자 사용 불가
- IN, ANY, ALL 등을 사용
### 1. IN : = or 의 결합 (sal=100 or sal=200 ...)
### 2. ANY : 비교연산자 + or
    sal > any(100,300,400) --> sal>100 or sal>300 or sal>400
- ANY에서 =을 쓰면 IN과 동일한 효과
### 3. ALL : 비교연산자 + and
    sal > all(100,300,400) --> sal>100 and sal>300 and sal>400
```mysql.sql
select ename, sal
from emp
where sal > any (
                    select sal
                    from emp
                    where deptno = 30
                );
```


## 상관 서브 쿼리 ⭐⭐⭐
- 외부 쿼리와 내부 쿼리가 서로 연관되어 있는 서브쿼리
```mysql.sql
-- 자신이 속한 부서의 평균 급여보다 많이 받는 사원
SELECT o.ename, o.sal, o.deptno
FROM emp o
WHERE o.sal > (
    SELECT AVG(i.sal)
    FROM emp i
    WHERE i.deptno = o.deptno
);
```

## EXISTS 연산자
```mysql.sql
-- 부하직원이 있는 직원만 조회
SELECT e.employee_id, e.first_name
FROM employees e
WHERE EXISTS (
    SELECT 1
    FROM employees s
    WHERE s.manager_id = e.employee_id
);
```
## 집합 연산자
- UNION (중복 제거 합집합)
- UNION ALL (중복 포함 합집합)
- INTERSECT (교집합)
    - MySQL은 직접 지원하지 않음, JOIN으로 구현
    ```mysql.sql
    -- INTERSECT 대체
    SELECT DISTINCT A.name
    FROM A
    INNER JOIN B ON A.name = B.name;
    ```
- MINUS (차집합)
    - MySQL은 직접 지원하지 않음, 서브쿼리로 구현
    ```mysql.sql
    -- MINUS 대체
    SELECT name FROM A
    WHERE name NOT IN (
    SELECT name FROM B
    );
    -- 결과: 1
    ```
## 윈도우 함수
### rank()
- rank() over(order by ~ desc) : ~를 내림차순으로 순위를 매김
### row_number()
- 행 번호 부여
### dense_rank()
- 동일 순위 다음 순위를 건너뛰지 않음 (1, 2, 3, 3, 4...)


## DML
- 데이터 조작어 : select, insert, update, delete
## DDL
- 데이터 정의어 : create, alter, drop, rename, truncate
## DCL
- 데이터 제어어 : grant, revoke
## TCL
- 트랜잭션 제어어 : commit, rollback, savepoint

### DDL(Data Definition Language)
- CREATE TABLE: 테이블 생성
- ALTER TABLE: 테이블 구조 변경
- DROP TABLE: 테이블 삭제
- RENAME: 이름 변경
- TRUNCATE: 테이블의 모든 데이터 삭제
- COMMENT: 테이블에 설명 추가

## MySQL 데이터 타입
| 분류  |                   	타입             |    설명     |
|:---:|:---------------------------------------:|:---------:|
| 숫자형 |          	INT, BIGINT, DECIMAL    |  	정수, 실수  |
| 문자형 |        	VARCHAR, CHAR, TEXT	        |    문자열    |
| 날짜형 |    	DATE, TIME, DATETIME, TIMESTAMP	 |  날짜와 시간   |
| 기타  |             JSON, BLOB	JSON         | 데이터, 바이너리 |
- varchar : 가변길이 텍스트 (최대 255)

## CREATE TABLE 제약조건
|제약조건|설명|
|:----:|:---:|
|NOT NULL	|NULL을 허용하지 않음|
|UNIQUE	|중복된 값을 허용하지 않음|
|PRIMARY KEY	|NOT NULL + UNIQUE|
|FOREIGN KEY	|다른 테이블 참조|
|DEFAULT	|기본값 설정|
|CHECK	|값의 범위 제한|
|AUTO_INCREMENT	|자동 증가|

### insert data
```mysql.sql
insert into 테이블 명(컬럼명...) values (값...);
```
- 앞에 나열된 컬럼명 순서대로 값이 나열되어야 함.

```mysql.sql
insert into 테이블 명 values (값...);
```
- 컬럼명 생략되면, desc 테이블명; 해서 나온 순서대로 모든 값이 나열 되어야 함.